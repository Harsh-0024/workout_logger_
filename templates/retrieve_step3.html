{% extends 'base.html' %}
{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card p-4 p-md-5 text-center">

            <h3 class="mb-3 fw-bold text-white tracking-wide">PLAN READY</h3>

            <textarea id="planText" class="form-control mb-5" rows="12"
                      style="font-family: 'SF Mono', 'Menlo', monospace; font-size: 0.85rem; background: #09090b;
                      border: 1px solid #27272a; color: #a1a1aa; border-radius: 4px; padding: 20px;"
                      readonly>{{ output }}</textarea>

            <div class="d-grid gap-3">
                <button onclick="manualCopy()" id="copyBtn" class="btn btn-gold-solid py-3 fw-bold"
                        style="text-transform: uppercase; letter-spacing: 1px; font-size: 0.9rem;">
                    Copy to Clipboard
                </button>

                <a href="/" class="text-muted text-decoration-none mt-3 small hover-gold"
                   style="text-transform: uppercase; letter-spacing: 1px;">Return Home</a>
            </div>
        </div>
    </div>
</div>

<script>
    function manualCopy() {
        var textArea = document.getElementById("planText");
        var btn = document.getElementById("copyBtn");

        textArea.select();
        textArea.setSelectionRange(0, 99999);

        // Try Copy
        try {
            navigator.clipboard.writeText(textArea.value).then(function() {
                updateButtonSuccess(btn);
            }, function() {
                // Fallback
                document.execCommand('copy');
                updateButtonSuccess(btn);
            });
        } catch (err) {
            document.execCommand('copy');
            updateButtonSuccess(btn);
        }
    }

    function updateButtonSuccess(btn) {
        var originalText = btn.innerText;
        btn.innerText = "COPIED SUCCESSFULLY";
        btn.style.backgroundColor = "#10b981"; // Emerald Green
        btn.style.color = "white";

        setTimeout(function() {
            btn.innerText = originalText;
            btn.style.backgroundColor = ""; // Revert to gold class
            btn.style.color = "";
        }, 2000);
    }
</script>
{% endblock %}